{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "A bar chart with negative values. We can hide the axis domain line, and instead use a conditional grid color to draw a zero baseline.",
  "width":"container",
  "data": {
    "url":"data/movers.csv"
  },
  "transform": [
    {"filter": "abs(datum['Change']) >= 10" },
    {"calculate": "toNumber(datum['Change']) + 1000", "as": "Pos"}
  ],
  "encoding": {
    "y": {
      "field": "Country name",
      "type": "nominal",
      "axis": null,
      "sort":["Pakistan",
        "El Salvador",
        "Benin",
        "Mexico",
        "Lebanon",
        "Turkey",
        "Algeria",
        "China",
        "Mongolia",
        "Estonia",
        "Albania",
        "Ukraine",
        "Gambia",
        "Serbia",
        "Bahrain",
        "Croatia",
        "Jamaica",
        "Armenia"]
    },"x": {
      "field": "Change",
      "type": "quantitative",
      "axis":null,
      "scale": {"padding": 20}
    }
  },
  "layer": [{
    "mark": {"type": "bar", "color": "#ddd"}
  }, {
    "mark": {
      "type": "text", 
      "align": {"expr": "datum.Change < 0 ? 'left' : 'right'"},
      "dx":{"expr": "datum.Change < 0 ? toNumber(datum.Change)*-2.2 +3 : toNumber(datum.Change)*-2.2 -3"}},
    "encoding": {
      "text": {"field": "Country name", "type": "nominal"}
    }
  }, {
    "mark": {
      "type": "text", 
      "align": {"expr": "datum.Change < 0 ? 'right' : 'left'"},
      "dx": {"expr": "datum.Change < 0 ? -2 : 2"}
    },
    "encoding": {
      "text": {"field": "Change"}
    }
  }
  ],
  "config": {
    "style": {
      "cell": {
        "stroke": "transparent"
      }
    }
  }
}